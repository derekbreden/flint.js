const $=(e,t)=>{const l=(e,t)=>{e.on=e.addEventListener.bind(e),e.forEach=e=>t.forEach(e),e.$=t=>$(t,e)};if("\n"===e.substr(0,1)){let n=e;const r=t;n=n.split("\n").filter((e=>""!==e.trim())).map((e=>({text:e.trim(),level:e.match(/^([\s]*)/)[0].length})));const c=(e,t=0,l=null)=>{if(t>=e.length)return null;const n=e[t],s=(n.text.match(/\[[^\]]*\]/g)||[]).map((e=>{let[t,l]=e.slice(1,-1).split("=");if(l&&l.startsWith("$")){const e=parseInt(l.slice(1))-1;l=r[e]}else l=l||"";return{key:t,value:l}}));n.text=n.text.replace(/\[[^\]]*\]/g,"");const i=n.text.split(" ");let a=i[0];const o=i.slice(1).join(" ");let u=null;if(a.startsWith("$")){const e=parseInt(a.slice(1))-1,t=r[e];"string"==typeof t?u=document.createTextNode(t):Array.isArray(t)?(u=document.createDocumentFragment(),t.forEach((e=>u.appendChild(e)))):u=t}else if(u=document.createElement(a),s.forEach((e=>{!1!==e.value&&null!==e.value&&void 0!==e.value&&u.setAttribute(e.key,e.value)})),o.includes("$")){const e=o.replace(/\$\d+/g,(e=>{const t=parseInt(e.slice(1))-1;return void 0!==r[t]?r[t]:e}));"TEXTAREA"===u.tagName?u.value=e:u.innerText=e}else o.length&&(u.innerText=o);l&&l.appendChild(u);let h=!1;for(let l=t+1;l<e.length&&e[l].level>n.level;l++)h||(h=e[l].level),e[l].level===h&&c(e,l,u);return u},s=document.createElement("div");let i=!1;for(let e=0;e<n.length;e++)if(i||(i=n[e].level),n[e].level===i){c(n,e,s)}return 1===s.children.length?(l(s.children[0]),s.children[0]):(l(s),s)}{const n=e,r=(t||document).querySelectorAll(n);return r.forEach((e=>l(e,r))),1===r.length?r[0]:0===r.length?null:r}};
